!function(){"use strict";class e{constructor(e){let t={root:null,rootMargin:"150px 0px 500px",threshold:this.buildThresholdList(),classTarget:this};this.observer=new IntersectionObserver(e,t)}addToObserver(e){this.observer.observe(e)}removeFromObserver(e){this.observer.unobserve(e)}buildThresholdList(){let e=[];for(let t=1;t<=6;t++){let i=t/6;e.push(i)}return e}}function t(e){let t=e.clientWidth,i=e.attributes.width?e.attributes.width.value:"auto",a=e.attributes.height?e.attributes.height.value:"auto",r="auto"===i||"auto"===a||"100%"===i||"100%"===a?e.clientHeight:parseInt(a/i*t);return t=parseInt(t),r=parseInt(r),isNaN(r)&&(r="auto"),{width:t,height:r}}function i(e,t){return Object.keys(t).forEach((function(i){e[i]=t[i]})),e}let a=new class{constructor(){this.serviceDomain=".i.optimole.com",this.serviceData={key:"undefined",quality:"auto",network_optimizations:!1,backgroundReplaceClasses:[],backgroundLazySelectors:"",watchClasses:[],lazyloadOnly:"",scalingDisabled:!1,ignoreDpr:!0},"undefined"!=typeof optimoleData&&optimoleData===Object(optimoleData)&&(this.serviceData=i(this.serviceData,optimoleData)),this.aTag=null}_cdnKey(){return this.serviceData.key.toLowerCase()}_sortByKey(e){const t={};return Object.keys(e).sort().forEach(i=>{t[i]=e[i]}),t}getAbsoluteUrl(e){return null===this.aTag&&(this.aTag=document.createElement("a")),this.aTag.href=e,this.aTag.href}getImageCDNUrl(e,t){if(e.includes(this.serviceDomain))return e;if("undefined"===this._cdnKey()||""===this._cdnKey())return e;e=this.getAbsoluteUrl(e);const i=`https://${this._cdnKey()}${this.serviceDomain}`;let a=this.serviceData.quality,r=e.split("://"),s=r[0],n=r[1];"auto"!==t.width&&(t.width=Math.round(t.width)),"auto"!==t.height&&(t.height=Math.round(t.height)),"eco"===t.quality&&(a=t.quality);let o={path:encodeURIComponent(n.replace(/\/$/,"")),scheme:s+":/",width:"w:"+t.width.toString(),height:"h:"+t.height.toString(),quality:"q:"+a.toString()},l=[i,(o=this._sortByKey(o)).width,o.height,o.quality,o.scheme,n];return!1===this.serviceData.ignoreDpr&&window.devicePixelRatio>1&&l.splice(4,0,"dpr:"+window.devicePixelRatio.toFixed(1).toString()),l.join("/")}updateImages(e){let t=document.getElementsByTagName("img");for(let i=0;i<t.length;i++)e.lazyLoadImage({target:t[i]})}requiresBetterQuality(e){return void 0===e.dataset.optOtimizedWidth||void 0===e.dataset.optOptimizedHeight||(parseInt(e.dataset.optOtimizedWidth)<parseInt(e.clientWidth)||parseInt(e.dataset.optOtimizedHeight)<parseInt(e.clientHeight))}transformURL(e,t){let[i,a]=e.split("://");if("http"!==i&&"https"!==i)return e;if(""===a||"undefined"===a)return e;const r=new RegExp("(?:(w|h|q):)?(([0-9.]+|auto|eco))","gm");let s,n=[],o="",l=navigator.connection||navigator.mozConnection||navigator.webkitConnection;for(l&&(o=l.effectiveType);null!==(s=r.exec(e));){s.index===r.lastIndex&&r.lastIndex++;let e=["w","h","q"];if(void 0!==s[1]&&-1!==e.indexOf(s[1])){let e=s[2];switch(s[1]){case"w":e=this.sizeSafe(this.sizeForConnection(o,t.width));break;case"h":e=this.sizeSafe(this.sizeForConnection(o,t.height));break;case"q":let i=s[2];void 0!==t.quality&&t.quality!==i&&(i=t.quality),e=this.qualityForConnection(o,i),!1===this.serviceData.ignoreDpr&&window.devicePixelRatio>1&&(e+="/dpr:"+window.devicePixelRatio.toFixed(1).toString())}let i=s[1]+":"+s[2],a=s[1]+":"+e;n.push({find:i.toString(),replace:a.toString()})}}let c=e;if(0===n.length)return e;for(let e in n)void 0!==n[e].find&&void 0!==n[e].replace&&(c=c.replace(n[e].find.toString(),n[e].replace.toString()));return c}sizeSafe(e){return null===e||"undefined"===e||"0"===e||0===e||isNaN(e)?"auto":e}qualityForConnection(e,t){if(!0!==this.network_optimizations)return t;let i;switch(e){case"4g":case"3g":i=t;break;case"2g":case"slow-2g":i="45";break;default:i=t}return i}sizeForConnection(e,t){if(!0!==this.network_optimizations)return t;let i=window.devicePixelRatio;switch(e){case"3g":return Math.round(t/i);case"2g":case"slow-2g":return Math.round(t/i);case"4g":default:return t}}getCDNForImage(e,a){let r=t(e);return r=i(r,a),{url:this.transformURL(this.getImageCDNUrl(e.dataset.optSrc,r),r),size:r}}},r=new class{constructor(e=null){this.replacerService=e}onlyLazyload(e){return void 0!==this.replacerService.serviceData.scalingDisabled&&!0===this.replacerService.serviceData.scalingDisabled||""!==this.replacerService.serviceData.lazyloadOnly&&e.classList.contains(this.replacerService.serviceData.lazyloadOnly)}requiresBetterQuality(e){return null===this.replacerService||"undefined"===this.replacerService||this.replacerService.requiresBetterQuality(e)}getImageSrc(e,a={}){let r=t(e);return r=i(r,a),null!==this.replacerService&&"undefined"!==this.replacerService?this.onlyLazyload(e)?{url:e.dataset.optSrc,size:r}:this.replacerService.getCDNForImage(e,r):"undefined"!==a&&"undefined"!==a.quality&&"eco"===a.quality?{url:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",size:r}:{url:e.dataset.optSrc,size:r}}prepareImage(e,t){let i=e.target;if((void 0===i.src||""===i.src)&&i.dataset.optSrc){let e={quality:"eco"},t=this.getImageSrc(i,e);i.src=t.url}t.addToObserver(i)}skipLazyLoad(e){let t=e.target;if(t.dataset.optSrc){let e=this.getImageSrc(t);t.src=e.url,t.dataset.optLazyLoaded="true"}}lazyLoadImage(e){let t=e.target;if(void 0!==t.dataset.optSrc&&this.requiresBetterQuality(t)&&"true"!==t.dataset.optLazyLoaded){let e=this.getImageSrc(t),i=e.url,a=new Image;t.classList.add("optml_lazyload_img");let r=this;return a.onload=async function(){this.complete&&(t.src=this.src,t.dataset.optLazyLoaded="true",null!==r.replacerService.serviceData&&!1===r.replacerService.serviceData.ignoreDpr&&window.devicePixelRatio>1&&(!r.onlyLazyload(t)&&"auto"!==e.size.width&&e.size.width>0&&(t.style.maxWidth=`${e.size.width}px`),!t.width&&!t.height&&!t.classList.contains(r.replacerService.serviceData.lazyloadOnly)&&"auto"!==e.size.width&&"auto"!==e.size.height&&e.size.width>0&&e.size.height>0&&(t.width=`${e.size.width}`,t.height=`${e.size.height}`)),t.dataset.optOtimizedWidth=`${e.size.width}`,t.dataset.optOptimizedHeight=`${e.size.height}`,t.classList.remove("optml_lazyload_img"))},void(a.src=i)}if(null!==this.replacerService&&void 0!==this.replacerService){if("true"!==t.dataset.optLazyLoaded&&this.replacerService.serviceData.watchClasses.length>0)for(let e=0;e<this.replacerService.serviceData.watchClasses.length;e++)if(t.classList.contains(this.replacerService.serviceData.watchClasses[e]))return void this.lazyLoadWatchClass(t);if(this.replacerService.serviceData.backgroundReplaceClasses.length>0)for(let e=0;e<this.replacerService.serviceData.backgroundReplaceClasses.length;e++)if(t.classList.contains(this.replacerService.serviceData.backgroundReplaceClasses[e]))return void this.lazyLoadImageBackground(t)}}lazyLoadWatchClass(e){let t={width:"auto",height:"auto",quality:"auto"},i=e.src,a=this.replacerService.transformURL(i,t),r=new Image;r.onload=async function(){this.complete&&(e.src=this.src,e.dataset.optLazyLoaded="true",e.dataset.optOtimizedWidth=`${t.width}`,e.dataset.optOptimizedHeight=`${t.height}`)},r.src=a}lazyLoadImageBackground(e){let i=t(e);i.quality="auto","undefined"!==this.replacerService.serviceData.quality&&(i.quality=this.replacerService.serviceData.quality);let a=e.style.backgroundImage.slice(4,-1).replace(/['"]/g,"");if(-1===a.indexOf("/q:eco/")||"true"===e.dataset.optLazyLoaded)return;let r=this.replacerService.transformURL(a,i),s=new Image;e.dataset.optLazyLoaded="true",s.onload=async function(){this.complete&&(e.style.backgroundImage=`url(${this.src})`,e.setAttribute("src",this.src))},s.src=r}}(a),s=new e((function(e,t){e.forEach((function(e){if(e.isIntersecting){if(function(){try{return window.self!==window.top}catch(e){return!0}}())return r.skipLazyLoad(e),void t.unobserve(e.target);r.lazyLoadImage(e),t.unobserve(e.target)}}))})),n=new e((function(e,t){e.forEach((function(e){e.isIntersecting&&(e.target.classList.contains("optml-bg-lazyloaded")||(e.target.classList.add("optml-bg-lazyloaded"),t.unobserve(e.target)))}))})),o=function(e){if(null!==r.replacerService&&"undefined"!==r.replacerService&&r.replacerService.serviceData.backgroundReplaceClasses.length>0){if(void 0===e.classList||0===e.classList.length)return!1;for(let t=0;t<r.replacerService.serviceData.backgroundReplaceClasses.length;t++)if(e.classList.contains(r.replacerService.serviceData.backgroundReplaceClasses[t]))return!0}return!1},l=function(e){(1===e.nodeType&&"IMG"===e.tagName||o(e))&&r.prepareImage({target:e},s);let t=e.childNodes;for(let e=0;e<t.length;e++)1===t[e].nodeType&&l(t[e])};new class{constructor(e){this.observer=new MutationObserver(e)}init(){let e=document.getElementsByTagName("html")[0];this.addToObserver(e)}addToObserver(e){this.observer.observe(e,{attributes:!0,childList:!0,subtree:!0})}}((function(e,t){for(let t of e){if("childList"===t.type)for(let e=0;e<t.addedNodes.length;e++){let i=t.addedNodes[e];l(i)}if("attributes"===t.type){let e=t.target.getElementsByTagName("img");for(let t=0;t<e.length;t++)r.prepareImage({target:e[t]},s)}}if(null!==r.replacerService&&"undefined"!==r.replacerService&&""!==r.replacerService.serviceData.backgroundLazySelectors){const e=document.querySelectorAll(r.replacerService.serviceData.backgroundLazySelectors);for(let t=0;t<e.length;t++)n.addToObserver(e[t])}})).init(),"loading"!==document.readyState?u():document.addEventListener("DOMContentLoaded",u);let c=document.getElementsByTagName("img");for(let e=0;e<c.length;e++)r.prepareImage({target:c[e]},s);let d=document.getElementsByTagName("div");for(let e=0;e<d.length;e++)o(d[e])&&r.prepareImage({target:d[e]},s);let h=window.innerWidth;function u(){if(null!==r.replacerService&&"undefined"!==r.replacerService&&""!==r.replacerService.serviceData.backgroundLazySelectors){const e=document.querySelectorAll(r.replacerService.serviceData.backgroundLazySelectors);for(let t=0;t<e.length;t++)n.addToObserver(e[t])}let e;window.addEventListener("resize",(function(){clearTimeout(e),e=setTimeout((function(){let e=new Event("resize-end");window.dispatchEvent(e)}),500)}))}window.addEventListener("resize-end",(function(){let e=window.innerWidth;1.15*h<=e&&a.updateImages(r),h=e}))}();
